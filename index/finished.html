<meta charset="UTF-8">
<html>
<head>
	<title>Finished</title>
	<link rel="stylesheet" type="text/css" href="https://www.psycholinguistics.ml/css/global_main.css">
	<link rel="stylesheet" type="text/css" href="https://www.psycholinguistics.ml/css/global_mainB.css">
	<link rel="stylesheet" type="text/css" href="https://www.psycholinguistics.ml/css/Form.css">
</head>

<body style="text-align:center;">
	<p>
		You finished the experiment. To confirm, please type in your Prolific ID again.
	</p>
	<p>
		<form method="post" onsubmit="return checkValid();" action="https://www.psycholinguistics.ml/confirm.php">
			<p>
				<textarea id=prolificID name="prolificID" maxlength=50 class="obligatory" required="required" rows="2" cols="40"></textarea>
			</p>
			<p id=message style="color:red;">
			</p>
			<p>
				<input type="submit" value="Submit">
			</p>
		</form>
	</p>
</body>

<script>
	function setCookie(cname, cvalue, exdays) {
		var d = new Date();
		d.setTime(d.getTime() + (exdays*24*60*60*1000));
		var expires = "expires="+ d.toUTCString();
		document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
	}

	function getCookieValue(a) {
		var b = document.cookie.match('(^|[^;]+)\\s*' + a + '\\s*=\\s*([^;]+)');
		return b ? b.pop() : '';
	}

	function getID() {
		var user_id = getCookieValue("id");
		if (user_id != "") {
			return user_id;			
		} else {
			window.location.href = "https://www.psycholinguistics.ml/cookie_error.html";
		}
	}		
	function checkValid() {
		var id = getID();
		if (!id.startsWith(document.getElementById("prolificID").value)){
			document.getElementById("message").innerHTML = "ERROR: ID not recognized. Check that it is correct.";
			return false;			
		} else if (getCookieValue("progress")!="3"){
			document.getElementById("message").innerHTML = "ERROR: Wrong progress state.";
			return false;				
		} else {return true};		
	
	}
</script>

</html>